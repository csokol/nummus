{"version":3,"sources":["main/js/application/AmountFormatter.js","main/js/application/components/AmountInput.js","main/js/application/components/ExpenseForm.js","main/js/domain/Expense.js","main/js/domain/UUIDGenerator.js","main/js/domain/AmountSpent.js","main/js/domain/ExpenseRepository.js","main/js/domain/MonthlyBudget.js","main/js/domain/CategoryBudget.js","main/js/domain/BudgetRepository.js","main/js/application/components/ExpenseHistory.js","main/js/domain/Category.js","main/js/domain/CategoryRepository.js","main/js/domain/AutoIncrementIdGenerator.js","main/js/application/components/ExpensesDash.js","main/js/application/components/BudgetDash.js","main/js/application/components/MonthSelector.js","main/js/domain/SyncService.js","main/js/application/components/AdminDash.js","main/js/application/components/App.js","main/js/registerServiceWorker.js","index.js"],"names":["AmountFormatter","decimalSeparator","arguments","length","undefined","Object","classCallCheck","this","inputDigits","cents","formattedCents","centsPart","substring","unitsPart","concat","missingDigits","toConsumableArray","Array","keys","reduce","v","parseInt","digit","amountCents","formatter","value","toString","i","keyDown","charAt","clear","AmountInput","props","_this","possibleConstructorReturn","getPrototypeOf","call","amountFormatter","fromCents","initialValue","_amount","state","formattedValue","formatted","event","key","preventDefault","keyCode","charCodeAt","isBackspace","isDigit","backspace","String","fromCharCode","onDigit","onAmountChanged","valueCents","setState","_this2","react_default","a","createElement","type","className","inputClass","name","onChange","onKeyDown","amountChanged","bind","ref","node","Component","defaultProps","console","warn","ExpenseForm","_validationMessages","amount","empty","target","categorySelected","categories","filter","c","id","category","onSubmit","validationErrors","push","where","onValidationError","comment","_category","_comment","objectSpread","_this3","map","index","components_AmountInput","clearErrors","defaultValue","formSubmitted","onClick","_submit","e","submit","toLocaleString","Expense","parameters","dateProvider","moment","categoryId","deleted","now","setDate","date","day","month","year","hour","minute","units","yearMonth","getDateMoment","format","fmtDate","obj","expense","UUIDGenerator","uuid","currentDateProvider","AmountSpent","spentPreviousMonth","_dateProvider","projected","_calculateProjection","rate","_calculateSpentRateVsPreviousMonth","today","endOfMonth","endOf","Math","round","ExpenseRepository","localStorage","needsMigration","runV2Migration","getItem","listAll","_getExpenseKeys","JSON","parse","o","fromJsonObj","sort","b","diff","arrayJson","nummusPrefix","expenses","forEach","add","save","getYearMonth","items","_readMonthIndex","savedKey","_setMonthIndex","expenseKeys","setItem","stringify","generateKey","expenseJson","generateKeyById","removeItem","previousMonthAmounts","_amountsByCategory","previousMonth","Map","from","_ref","_ref2","slicedToArray","get","findBy","currentAmount","set","expenseIds","_loop","jsonString","_clearIndices","list","hardDelete","ids","repository","next","apiKey","lastSync","expensesByMonth","acc","item","_i","_Object$entries","entries","_ref5","_ref4","_monthIndex","Set","MonthlyBudget","categoryBudgets","CategoryBudget","budgeted","floor","BudgetRepository","categoryRepository","_localStorage","_categoryRepository","_initializeBudgets","_now","_findOrCreate","listMonths","m","found","budget","_parseObject","assign","fromCategory","newBudget","monthlyBudget","k","startsWith","YearMonth","month1","month2","toMoment","reverse","is_current","subtract","_class","ExpenseHistory","showCsv","categoriesById","formattedAmount","formattedDate","deleteExpense","rows","makeItem","expensesAsCsv","expenseRepository","delete","selectedMonth","_this4","tags","join","Category","CategoryRepository","localeCompare","AutoIncrementIdGenerator","ExpensesDash","components_ExpenseForm","expenseAdded","components_ExpenseHistory","_expenseHistory","nextId","idGenerator","createFromState","BudgetEntry","amountSpent","percentage","categoryName","BudgetDash","totalAmountSpent","_getAmountSpent","tbody","_ref3","BudgetDash_BudgetEntry","amountSpentByCategory","MonthSelector","onMonthChanged","budgetRepository","findMonth","months","currentMonth","options","monthChanged","SyncService","userUuid","_apiKey","_userUuid","dump","fetch","method","mode","headers","X-Api-Key","body","then","response","json","isArray","success","allExpenses","deletedExpenses","newExpenses","reason","AdminDash","loading","uploadCompleted","saveApiKey","setUserUuid","component","sync","result","deleteKeys","addExpenses","loadDump","uploadFailed","uploadExpenses","htmlFor","placeholder","apiKeyChanged","uuidChanged","App","thiz","shouldSync","synced","components_ExpensesDash","components_BudgetDash","amountsByCategory","syncBackendState","components_AdminDash","BrowserRouter","data-dropdown-menu","Link","to","components_MonthSelector","Route","exact","path","makeExpensesDash","makeBudgetDash","makeAdminDash","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","catch","error","ReactDOM","render","components_App","document","getElementById","addEventListener","platforms","userChoice","outcome","URL","process","origin","status","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.fe2101a4.chunk.js","sourcesContent":["\nclass AmountFormatter {\n\n  constructor(decimalSeparator = \".\") {\n    this.decimalSeparator = decimalSeparator;\n    this.inputDigits = '';\n  }\n\n  formatted() {\n    const cents = this.formattedCents();\n\n    let centsPart = cents.substring(cents.length - 2, cents.length);\n    let unitsPart = cents.substring(0, cents.length - 2);\n    return `${unitsPart}${this.decimalSeparator}${centsPart}`;\n  }\n\n  formattedCents() {\n    const missingDigits = 4 - this.inputDigits.length;\n    if (missingDigits > 0) {\n      const leftDigits = [...Array(missingDigits).keys()].reduce((v) => '0' + v, '');\n      return leftDigits + this.inputDigits;\n    } else {\n      return this.inputDigits;\n    }\n  }\n\n  valueCents() {\n    return parseInt(this.formattedCents(), 10);\n  }\n\n  keyDown(digit) {\n    this.inputDigits = this.inputDigits + digit;\n  }\n\n  backspace() {\n    this.inputDigits = this.inputDigits.substring(0, this.inputDigits.length - 1);\n  }\n\n  clear() {\n    this.inputDigits = '';\n  }\n\n  static fromCents(amountCents, decimalSeparator = \".\") {\n    const formatter = new AmountFormatter(decimalSeparator);\n    const value = amountCents.toString();\n    for (let i = 0; i < value.length; i++) {\n      formatter.keyDown(value.charAt(i));\n    }\n    if (amountCents === 0) {\n      formatter.clear();\n    }\n    return formatter;\n  }\n}\n\nexport default AmountFormatter;\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport AmountFormatter from \"../AmountFormatter\";\n\nclass AmountInput extends Component {\n\n  constructor(props) {\n    super(props);\n    this.amountFormatter = AmountFormatter.fromCents(this.props.initialValue);\n    this._amount = null;\n    this.state = {\n      value: this.props.initialValue,\n      formattedValue: this.amountFormatter.formatted()\n    };\n  }\n\n  static defaultProps = {\n    onDigit: () => console.warn(\"Unhadled onDigit\"),\n    onAmountChanged: () => undefined,\n    className: 'input-group-field amount-input',\n    initialValue: 0,\n  };\n\n  static propTypes = {\n    onDigit: PropTypes.func,\n    onAmountChanged: PropTypes.func,\n    initialValue: PropTypes.number,\n    inputClass: PropTypes.string,\n  };\n\n  amountChanged(event) {\n    let {key} = event;\n    event.preventDefault();\n    const keyCode = key.charCodeAt(0);\n    if (key === 'Tab') {\n      return;\n    }\n    event.preventDefault();\n    const isBackspace = key === 'Backspace';\n    const isDigit = keyCode >= '0'.charCodeAt(0) && keyCode <= '9'.charCodeAt(0);\n    if (isBackspace) {\n      this.amountFormatter.backspace();\n    } else if (isDigit) {\n      this.amountFormatter.keyDown(String.fromCharCode(keyCode));\n      this.props.onDigit(key);\n    }\n    this.props.onAmountChanged(this.amountFormatter.valueCents());\n    this.setState({\n      value: this.amountFormatter.valueCents(),\n      formattedValue: this.amountFormatter.formatted()\n    });\n  }\n\n  clear() {\n    this.amountFormatter.clear();\n    this.setState({\n      value: this.amountFormatter.valueCents(),\n      formattedValue: this.amountFormatter.formatted()\n    });\n  }\n\n  render() {\n    return (\n      <input\n        type='number'\n        className={this.props.inputClass}\n        name='amount'\n        onChange={() => undefined}\n        onKeyDown={this.amountChanged.bind(this)}\n        ref={(node) => {\n          this._amount = node;\n        }}\n        value={this.state.formattedValue}\n      />\n    );\n  }\n}\n\nexport default AmountInput\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport AmountFormatter from \"../AmountFormatter\";\nimport AmountInput from \"./AmountInput\";\n\nclass ExpenseForm extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this._validationMessages = {};\n    this.amountFormatter = new AmountFormatter();\n  }\n\n  static defaultProps = {\n    onSubmit: (e, submit) => console.warn(\"Unhadled onSubmit\"),\n    onValidationError: () => console.warn(\"Unhadled validation error\"),\n    categories: [],\n  };\n\n  static propTypes = {\n    categories: PropTypes.array,\n    onSubmit: PropTypes.func,\n    onValidationError: PropTypes.func,\n  };\n\n  amountChanged(event) {\n    let {key} = event;\n    const keyCode = key.charCodeAt(0);\n    if (key === 'Tab') {\n      return;\n    }\n    event.preventDefault();\n    const isBackspace = key === 'Backspace';\n    const isDigit = keyCode >= '0'.charCodeAt(0) && keyCode <= '9'.charCodeAt(0);\n    if (isBackspace) {\n      this.amountFormatter.backspace();\n    } else if (isDigit) {\n      this.amountFormatter.keyDown(String.fromCharCode(keyCode));\n      this._validationMessages.amount.empty.className = 'form-error';\n    }\n    this._amount.value = this.amountFormatter.formatted();\n    this.setState({amount: this.amountFormatter.valueCents()});\n  }\n\n  clearErrors() {\n    this._validationMessages.amount.empty.className = 'form-error';\n  }\n\n  categorySelected(event) {\n    let {value} = event.target;\n    let categorySelected = this.props.categories.filter(c => c.id === parseInt(value, 10))[0];\n    this._validationMessages.category.empty.className = 'form-error';\n    this.setState({category: categorySelected});\n  }\n\n  formSubmitted() {\n    let onSubmit = this.props.onSubmit;\n    return (event) => {\n      let state = this.state;\n      const {category} = state;\n      const amount = this._amount.state.value;\n      const validationErrors = [];\n      if (!category) {\n        validationErrors.push({where: \"category\", type: \"empty_field\"});\n        this._validationMessages.category.empty.className = 'form-error is-visible';\n      }\n      if (!amount) {\n        validationErrors.push({where: \"amount\", type: \"empty_field\"});\n        this._validationMessages.amount.empty.className = 'form-error is-visible';\n      }\n      if (validationErrors.length !== 0) {\n        event.preventDefault();\n        this.props.onValidationError(validationErrors);\n        return;\n      }\n      this.setState({amount: null, category: null, comment: null});\n      this.amountFormatter.clear();\n      this._amount.value = this.amountFormatter.formatted();\n      this._category.value = null;\n      this._comment.value = null;\n      this._amount.clear();\n      onSubmit(event, { ...state, amount: amount });\n    }\n  }\n\n  render() {\n    const categories = this.props.categories.map((category, index) => {\n      return <option key={index} value={category.id}>{category.name}</option>\n    });\n\n    return (\n        <form className='expense-form'>\n          <label>\n            <div>\n            Amount\n              <div className=\"input-group\">\n                <span className=\"input-group-label\">€</span>\n                <AmountInput\n                  ref={(node) => this._amount = node}\n                  onDigit={this.clearErrors.bind(this)}\n                  inputClass='input-group-field amount-input'\n                />\n              </div>\n              <div className='form-error-container'>\n                <span ref={node => this._validationMessages.amount = {empty: node}} className='form-error'>\n                  Amount cannot be empty\n                </span>\n              </div>\n            </div>\n          </label>\n\n          <label>\n            <div>\n              Category\n              <select\n                defaultValue={0}\n                className='expense-form-category' name='category'\n                onChange={this.categorySelected.bind(this)}\n                ref={(node) => this._category = node}\n              >\n                <option value={0} />\n                {categories}\n              </select>\n              <div className='form-error-container'>\n                <span ref={node => this._validationMessages.category = {empty: node}} className='form-error'>\n                    Category cannot be empty\n                </span>\n              </div>\n            </div>\n          </label>\n          <label>\n            <div>\n              Comment\n              <input\n                ref={(node) => this._comment = node}\n                type=\"text\"\n                className='expense-form-category' name='category'\n                onChange={(event) => this.setState({ comment: event.target.value })}\n              >\n              </input>\n            </div>\n          </label>\n\n          <input\n            type='submit'\n            className='expense-form-submit success button expanded large'\n            value='Add expense'\n            onSubmit={this.formSubmitted().bind(this)}\n            onClick={this.formSubmitted().bind(this)}\n            ref={(node) => this._submit = node}\n          />\n        </form>\n    );\n  }\n}\n\nexport default ExpenseForm\n","import moment from 'moment';\n\nconst decimalSeparator = (1.1).toLocaleString().substring(1, 2);\n\nclass Expense {\n  constructor(parameters, dateProvider = function() { return moment() }) {\n    const {id, amountCents, categoryId, comment, deleted} = parameters;\n    this.id = id;\n    this.amountCents = amountCents;\n    this.categoryId = categoryId;\n    this.comment = comment;\n    const now = dateProvider();\n    this.deleted = deleted || false;\n    this.setDate(now);\n  }\n\n  setDate(now) {\n    this.date = {\n      day: now.date(),\n      month: now.month() + 1,\n      year: now.year(),\n      hour: now.hour(),\n      minute: now.minute(),\n    }\n  }\n\n  static createFromState(id, state) {\n    let categoryId = state.category.id;\n\n    return new Expense({\n      id: id,\n      amountCents: state.amount,\n      categoryId: categoryId,\n      comment: state.comment\n    });\n  }\n\n  amountAsString() {\n    let cents = this.amountCents % 10;\n    let units = this.amountCents / 10;\n    return `${units}${decimalSeparator}${cents}`;\n  }\n\n  sameMonth(yearMonth) {\n    return this.getDateMoment().format(\"YYYY_MM\") === yearMonth.yearMonth;\n  }\n\n  getYearMonth() {\n    return this.getDateMoment().format(\"YYYY_MM\");\n  }\n\n  formattedDate() {\n    if (!this.date) {\n      return '-'\n    }\n    return this.getDateMoment().format(\"DD-MM-YYYY HH:mm\");\n  }\n\n  static fromJsonObj(obj) {\n    const expense = new Expense({\n      id: obj.id,\n      amountCents: obj.amountCents,\n      categoryId: obj.categoryId,\n      comment: obj.comment,\n      deleted: obj.deleted,\n    });\n\n    expense.date = obj.date;\n\n    if (expense.date) {\n      expense.date.hour = obj.date.hour || 12;\n      expense.date.minute = obj.date.minute || 0;\n    }\n    return expense;\n  }\n\n  getDateMoment() {\n    const fmtDate = `${this.date.day}-${this.date.month}-${this.date.year} ${this.date.hour}:${this.date.minute}`;\n    return moment(fmtDate, \"DD-MM-YYYY HH:mm\");\n  }\n}\n\nexport default Expense;\n","import uuid from 'uuid/v4';\n\nclass UUIDGenerator {\n  next() {\n    return uuid();\n  }\n}\n\nexport default UUIDGenerator;\n","import moment from \"moment\";\n\nfunction currentDateProvider() {\n  return moment();\n}\n\nclass AmountSpent {\n  constructor(amount, spentPreviousMonth = 0, dateProvider = currentDateProvider) {\n    this._dateProvider = dateProvider;\n    this.amount = amount;\n    this.projected = this._calculateProjection();\n    this.spentPreviousMonth = spentPreviousMonth;\n    this.rate = this._calculateSpentRateVsPreviousMonth();\n  }\n\n  _calculateProjection() {\n    const today = this._dateProvider().date();\n    const endOfMonth = this._dateProvider().endOf('month').date();\n\n    return Math.round((endOfMonth * this.amount) / today);\n  }\n  _calculateSpentRateVsPreviousMonth() {\n    if (this.amount && this.spentPreviousMonth) {\n      return Math.round((this.amount / this.spentPreviousMonth) * 100);\n    }\n    return undefined;\n  }\n}\n\nexport default AmountSpent;","import Expense from \"./Expense\";\nimport UUIDGenerator from \"./UUIDGenerator\";\nimport AmountSpent from \"./AmountSpent\";\nimport moment from 'moment';\n\nconst nummusPrefix = \"nummus.io\";\nconst expenseKeysKey = nummusPrefix + \".expenseKeys\";\n\nconst currentVersion = \"v2\";\n\nclass ExpenseRepository {\n  localStorage;\n\n  constructor(localStorage) {\n    this.localStorage = localStorage;\n    if (this.needsMigration()) {\n      this.runV2Migration();\n    }\n  }\n\n  needsMigration() {\n    return this.localStorage.getItem(`${nummusPrefix}.version`) !== \"v2\";\n  }\n\n  list() {\n    return this.listAll()\n      .filter(e => e.deleted !== true);\n  }\n\n  listAll() {\n    return this._getExpenseKeys()\n      .map(this.localStorage.getItem.bind(this.localStorage))\n      .map(JSON.parse)\n      .filter(o => o != null)\n      .map(Expense.fromJsonObj)\n      .sort((a, b) => -a.getDateMoment().diff(b.getDateMoment(), 'minutes'));\n  }\n\n  _getExpenseKeys() {\n    const arrayJson = this.localStorage.getItem(expenseKeysKey) || '[]';\n    return JSON.parse(arrayJson);\n  }\n\n  addRawExpenses(expenses) {\n    var expenseObjects = expenses.map(Expense.fromJsonObj);\n    expenseObjects.forEach(this.add.bind(this))\n  }\n\n  add(expense) {\n    let key = this.save(expense);\n\n    let yearMonth = expense.getYearMonth();\n    let items = this._readMonthIndex(yearMonth);\n\n    items = items.filter(savedKey => savedKey !== expense.id);\n    items.push(expense.id);\n    this._setMonthIndex(yearMonth, items);\n\n    let expenseKeys = this._getExpenseKeys();\n    expenseKeys = expenseKeys.filter(savedKey => savedKey !== key);\n    expenseKeys.push(key);\n    this.localStorage.setItem(expenseKeysKey, JSON.stringify(expenseKeys));\n  }\n\n  save(expense) {\n    let key = `${this.generateKey(expense)}`;\n    let expenseJson = JSON.stringify(expense);\n\n    this.localStorage.setItem(key, expenseJson);\n    return key;\n  }\n\n  _readMonthIndex(yearMonth) {\n    let index = this.localStorage.getItem(`v2.nummus.io.months-index.${yearMonth}`) || '[]';\n    return JSON.parse(index);\n  }\n\n  generateKey(expense) {\n    return this.generateKeyById(expense.id);\n  }\n\n  generateKeyById(id) {\n    return `${nummusPrefix}.expenses.${id}`;\n  }\n\n  delete(expense) {\n    let key = `${nummusPrefix}.expenses.${expense.id}`;\n    expense.deleted = true;\n    this.localStorage.setItem(key, JSON.stringify(expense));\n  }\n\n  hardDelete(expense) {\n    let key = `${nummusPrefix}.expenses.${expense.id}`;\n    let expenseKeys = this._getExpenseKeys();\n    this.localStorage.removeItem(key);\n    expenseKeys = expenseKeys.filter(savedKey => savedKey !== key);\n    this.localStorage.setItem(expenseKeysKey, JSON.stringify(expenseKeys));\n  }\n\n  amountsByCategory(yearMonth) {\n    let previousMonthAmounts = this._amountsByCategory(yearMonth.previousMonth());\n    return new Map(Array.from(this._amountsByCategory(yearMonth)).map(([id, amount]) => {\n        return [id, new AmountSpent(amount, previousMonthAmounts.get(id))]\n      }\n    ));\n  }\n\n  _amountsByCategory(yearMonth) {\n    return this.findBy(yearMonth)\n      .reduce((map, expense) => {\n        const currentAmount = map.get(expense.categoryId) ? map.get(expense.categoryId) : 0;\n        map.set(expense.categoryId, currentAmount + expense.amountCents);\n        return map;\n      }, new Map());\n  }\n\n  dump() {\n    return JSON.stringify(this.listAll());\n  }\n\n  deleteKeys(expenseIds) {\n    let expenseKeys = this._getExpenseKeys();\n    for (let index in expenseIds) {\n      let key = `${nummusPrefix}.expenses.${expenseIds[index]}`;\n      this.localStorage.removeItem(key);\n      expenseKeys = expenseKeys.filter(savedKey => savedKey !== key);\n    }\n    this.localStorage.setItem(expenseKeysKey, JSON.stringify(expenseKeys));\n  }\n\n  addExpenses() {\n\n  }\n\n  loadDump(jsonString) {\n    this._clearIndices();\n    this.list().forEach(this.hardDelete.bind(this));\n    JSON.parse(jsonString)\n      .map(Expense.fromJsonObj)\n      .forEach(this.add.bind(this));\n  }\n\n  findBy(yearMonth) {\n    let ids = this._readMonthIndex(yearMonth.yearMonth);\n    let repository = this;\n    return ids.map(id => repository.localStorage.getItem(repository.generateKeyById(id)))\n      .filter(e => e != null)\n      .map(JSON.parse)\n      .map(Expense.fromJsonObj)\n      .filter(e => e.deleted !== true)\n      .sort((a, b) => -a.getDateMoment().diff(b.getDateMoment(), 'minutes'));\n  }\n\n  userUuid() {\n    let key = nummusPrefix + \".userUuid\";\n    let uuid = this.localStorage.getItem(key) || new UUIDGenerator().next();\n    this.localStorage.setItem(key, uuid);\n\n    return uuid;\n  }\n\n  setUserUuid(uuid) {\n    let key = nummusPrefix + \".userUuid\";\n    this.localStorage.setItem(key, uuid);\n  }\n\n  apiKey() {\n    let key = nummusPrefix + \".apiKey\";\n    return this.localStorage.getItem(key);\n  }\n\n  saveApiKey(apiKey) {\n    let key = nummusPrefix + \".apiKey\";\n    this.localStorage.setItem(key, apiKey);\n  }\n\n  shouldSync(now) {\n    let lastSync = this.localStorage.getItem(nummusPrefix + \".lastSync\");\n    if (!lastSync) {\n      return true;\n    }\n    let lastSyncMoment = moment(lastSync, \"YYYYMMDDHH\");\n\n    let difference = lastSyncMoment.add(7, 'day')\n      .diff(moment(), 'hours');\n\n    return difference < 0;\n  }\n\n  synced() {\n    this.localStorage.setItem(\n      nummusPrefix + \".lastSync\",\n      moment().format(\"YYYYMMDDHH\")\n    );\n  }\n\n  runV2Migration() {\n    let expensesByMonth = this.listAll().reduce((acc, item) => {\n      if (!acc[item.getYearMonth()]) {\n        acc[item.getYearMonth()] = [];\n      }\n      acc[item.getYearMonth()].push(item.id);\n      return acc;\n    }, {});\n\n    for (let [month, expenses] of Object.entries(expensesByMonth)) {\n      this._setMonthIndex(month, expenses);\n    }\n    this.localStorage.setItem(`${nummusPrefix}.version`, \"v2\");\n  }\n\n  _setMonthIndex(month, expenseIds) {\n    this.localStorage.setItem(ExpenseRepository._monthIndex(month), JSON.stringify(expenseIds));\n  }\n\n  static _monthIndex(month) {\n    return `v2.nummus.io.months-index.${month}`;\n  }\n\n  _clearIndices() {\n    let repository = this;\n    new Set(this.list().map(e => e.getYearMonth()))\n      .forEach(month => repository.localStorage.removeItem(ExpenseRepository._monthIndex(month)));\n  }\n}\n\nexport default ExpenseRepository;\n","class MonthlyBudget {\n  constructor(id, categoryBudgets, month) {\n    this.id = id;\n    this.categoryBudgets = categoryBudgets;\n    this.month = month;\n  }\n\n}\n\nexport default MonthlyBudget;\n","const decimalSeparator = (1.1).toLocaleString().substring(1, 2);\n\nclass CategoryBudget {\n  constructor(id, budgeted, categoryId) {\n    this.id = id;\n    this.budgeted = budgeted;\n    this.categoryId = categoryId;\n  }\n\n  static fromCategory(yearMonth) {\n    return (category) =>\n      new CategoryBudget(`${category.id}_${yearMonth}`, 0, category.id);\n  }\n\n  setBudget(budgeted) {\n    this.budgeted = budgeted;\n  }\n\n  formatedBudgetedAmount() {\n    let cents = this.budgeted % 100;\n    let units = Math.floor(this.budgeted / 100);\n    return `${units}${decimalSeparator}${cents}`;\n  }\n}\n\nexport default CategoryBudget;\n","import moment from 'moment';\nimport MonthlyBudget from \"./MonthlyBudget\";\nimport CategoryBudget from \"./CategoryBudget\";\n\nconst nummusPrefix = \"nummus.io\";\n\nclass BudgetRepository {\n  constructor(localStorage, categoryRepository, dateProvider = currentDateProvider) {\n    this._localStorage = localStorage;\n    this._categoryRepository = categoryRepository;\n    this._dateProvider = dateProvider;\n    this._initializeBudgets();\n  }\n\n  list() {\n    return this.categories;\n  }\n\n  _now() {\n    return this._dateProvider()\n  }\n\n  currentMonthlyBudget() {\n    const yearMonth = this._now().format(\"YYYY_MM\");\n    return this._findOrCreate(yearMonth);\n  }\n\n  findMonth(yearMonth) {\n    return this.listMonths().filter(m => m.yearMonth === yearMonth)[0];\n  }\n\n  _findOrCreate(yearMonth) {\n    const key = `${nummusPrefix}.monthlyBudgets.${yearMonth}`;\n    const found = this._localStorage.getItem(key);\n\n    if (found) {\n      const budget = this._parseObject(found);\n      budget.categoryBudgets = budget.categoryBudgets.map(obj => Object.assign(new CategoryBudget(), obj));\n      return budget;\n    }\n\n    const categoryBudgets = this._categoryRepository.list()\n      .map(CategoryBudget.fromCategory(yearMonth));\n\n    const newBudget = new MonthlyBudget(key, categoryBudgets, yearMonth);\n\n    this._localStorage.setItem(key, JSON.stringify(newBudget));\n    return newBudget;\n  }\n\n  _parseObject(found) {\n    return Object.assign(new MonthlyBudget(), JSON.parse(found));\n  }\n\n  update(monthlyBudget) {\n    const key = `${nummusPrefix}.monthlyBudgets.${monthlyBudget.month}`;\n    this._localStorage.setItem(key, JSON.stringify(monthlyBudget));\n  }\n\n  listMonths() {\n    return Object.keys(this._localStorage)\n      .filter(k => k.startsWith(\"nummus.io.monthlyBudgets\"))\n      .map(k => this._parseObject(this._localStorage.getItem(k)))\n      .map(budget => new BudgetRepository.YearMonth(budget.month, this._dateProvider))\n      .sort((month1, month2) => -month1.toMoment().diff(month2.toMoment(), 'minutes'))\n      .reverse()\n  }\n\n  currentMonth() {\n    return this.listMonths().filter(m => m.is_current)[0];\n  }\n\n  _initializeBudgets() {\n    this._findOrCreate(this._now().add(1, 'month').format(\"YYYY_MM\"));\n    this._findOrCreate(this._now().format(\"YYYY_MM\"));\n    this._findOrCreate(this._now().subtract(1, 'month').format(\"YYYY_MM\"));\n  }\n\n  static YearMonth = class {\n    constructor(yearMonth, dateProvider = currentDateProvider) {\n      this.is_current = dateProvider().format(\"YYYY_MM\") === yearMonth;\n      this.yearMonth = yearMonth;\n    }\n\n    formatted() {\n      return this.toMoment().format(\"MMM YY\");\n    }\n\n    toMoment() {\n      return moment(this.yearMonth, \"YYYY_MM\")\n    }\n\n    previousMonth() {\n      return new BudgetRepository.YearMonth(\n        this.toMoment().subtract(1, 'months').format(\"YYYY_MM\")\n      );\n    }\n\n  }\n}\n\nfunction currentDateProvider() {\n  return moment();\n}\n\nexport default BudgetRepository;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport ExpenseRepository from \"../../domain/ExpenseRepository\";\nimport AmountFormatter from \"../AmountFormatter\";\nimport BudgetRepository from \"../../domain/BudgetRepository\";\n\n\nclass ExpenseHistory extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      expenses: this.props.expenses,\n      showCsv: false\n    };\n  }\n\n  static propTypes = {\n    expenseRepository: PropTypes.instanceOf(ExpenseRepository),\n    selectedMonth: PropTypes.instanceOf(BudgetRepository.YearMonth),\n    expenses: PropTypes.array,\n    categoriesById: PropTypes.object,\n  };\n\n  makeItem(expense, index) {\n    let category = this.props.categoriesById.get(expense.categoryId);\n    const formattedAmount = AmountFormatter.fromCents(expense.amountCents).formatted();\n    return (<tr className=\"expense-row\" key={index}>\n      <td>{expense.formattedDate()}</td>\n      <td>€{formattedAmount}</td>\n      <td>{category.name}</td>\n      <td>\n        <input\n          type='button'\n          value='Delete'\n          className='delete-expense alert button expanded'\n          onClick={this.deleteExpense(expense).bind(this)}\n        />\n      </td>\n    </tr>)\n  }\n\n  render() {\n    const rows = this.state.expenses.map(this.makeItem.bind(this));\n    return (\n      <div>\n        <table>\n          <tbody>\n          {rows}\n          </tbody>\n        </table>\n        <button className=\"button expanded large\" onClick={() => this.setState({showCsv: !this.state.showCsv})}>As csv</button>\n        <div className={this.state.showCsv ? \"\" : \"hide\"}>\n          <pre>{this.expensesAsCsv()}</pre>\n        </div>\n      </div>\n    );\n  }\n\n  deleteExpense(expense) {\n    return () => {\n      this.props.expenseRepository.delete(expense);\n      this.setState({expenses: this.props.expenseRepository.findBy(this.props.selectedMonth)});\n    }\n  }\n\n  expensesAsCsv() {\n    return this.props.expenses.map(e => {\n      const formattedAmount = AmountFormatter.fromCents(e.amountCents, \",\").formatted();\n      let category = this.props.categoriesById.get(e.categoryId);\n      return `${e.formattedDate()}\\t${formattedAmount}\\t${category.name}\\t${category.tags}\\t${e.comment || \"\"}`\n    }).reverse().join(\"\\n\") + \"\\n\\n\";\n  }\n}\n\nexport default ExpenseHistory\n","class Category {\n  constructor(id, name, tags) {\n    this.name = name;\n    this.id = id;\n    this.tags = tags;\n  }\n\n}\n\nexport default Category;\n","import Category from \"./Category\";\n\nclass CategoryRepository {\n\n  constructor() {\n    const categories = [\n      { name: 'fun', tags: [\"non-essential\"] },\n      { name: 'groceries', tags: [\"essential\"] },\n      { name: 'travel', tags: [\"non-essential\"] },\n      { name: 'dining out', tags: [\"non-essential\"] },\n      { name: 'rent', tags: [\"essential\"] },\n      { name: 'utilities', tags: [\"essential\"] },\n      { name: 'sports', tags: [\"non-essential\"] },\n      { name: 'transportation', tags: [\"essential\"] },\n      { name: 'lunch @ work', tags: [\"essential\"] },\n      { name: 'children', tags: [\"essential\"] },\n      { name: 'clothing', tags: [\"non-essential\"] },\n      { name: 'unexpected', tags: [\"essential\"] },\n      { name: 'coffee', tags: [\"non-essential\"] },\n    ].map((category, index) => {\n      return new Category(index, category.name, category.tags)\n    });\n\n    this.categories = categories.sort((a, b) => a.name.localeCompare(b.name));\n  }\n\n  list() {\n    return this.categories;\n  }\n\n  categoriesById() {\n    return this.list().reduce((map, v) => map.set(v.id, v), new Map())\n  }\n}\n\nexport default CategoryRepository;\n","class AutoIncrementIdGenerator {\n  id;\n\n  constructor() {\n    this.id = 0;\n  }\n\n  next() {\n    this.id++;\n    return this.id;\n  }\n}\n\nexport default AutoIncrementIdGenerator;\n","import React, {Component} from 'react';\nimport '../../../css/App.css';\nimport '../../../css/index.css';\nimport ExpenseForm from \"./ExpenseForm\";\nimport ExpenseHistory from \"./ExpenseHistory\";\nimport Expense from \"../../domain/Expense\";\nimport ExpenseRepository from \"../../domain/ExpenseRepository\";\nimport CategoryRepository from \"../../domain/CategoryRepository\";\nimport AutoIncrementIdGenerator from \"../../domain/AutoIncrementIdGenerator\";\nimport PropTypes from 'prop-types';\nimport BudgetRepository from \"../../domain/BudgetRepository\";\n\nclass ExpensesDash extends Component {\n\n  constructor(props) {\n    super(props);\n    this.categories = this.props.categoryRepository.list();\n    this.categoriesById = this.props.categoryRepository.categoriesById();\n    this.expenseRepository = this.props.expenseRepository || new ExpenseRepository(localStorage);\n    this.state = {\n      expenses: this.expenseRepository.findBy(this.props.selectedMonth)\n    };\n  }\n\n  static defaultProps = {\n    idGenerator: new AutoIncrementIdGenerator(),\n  };\n\n  static propTypes = {\n    idGenerator: PropTypes.shape({\n      next: PropTypes.func,\n    }),\n    categoryRepository: PropTypes.instanceOf(CategoryRepository),\n    expenseRepository: PropTypes.instanceOf(ExpenseRepository),\n    selectedMonth: PropTypes.instanceOf(BudgetRepository.YearMonth),\n  };\n\n\n  render() {\n    return (\n      <div className=\"grid-x grid-padding-x\">\n          <div className=\"large-6 medium-6 cell\">\n            <ExpenseForm\n                categories={this.categories}\n                onSubmit={this.expenseAdded.bind(this)}\n            />\n          </div>\n          <div className=\"large-6 medium-6 cell\">\n            <ExpenseHistory\n                categoriesById={this.categoriesById}\n                expenses={this.state.expenses}\n                expenseRepository={this.expenseRepository}\n                selectedMonth={this.props.selectedMonth}\n                ref={(node) => this._expenseHistory = node}\n            />\n          </div>\n      </div>\n    );\n  }\n\n  expenseAdded(event, state) {\n    event.preventDefault();\n\n    const nextId = this.props.idGenerator.next();\n    let expense = Expense.createFromState(nextId, state);\n    this.expenseRepository.add(expense);\n\n    this._expenseHistory.setState({\n      expenses: this.expenseRepository.findBy(this.props.selectedMonth)\n    });\n\n    this.setState({\n      expenses: this.expenseRepository.findBy(this.props.selectedMonth)\n    });\n  }\n}\n\nexport default ExpensesDash;\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport CategoryRepository from \"../../domain/CategoryRepository\";\nimport BudgetRepository from \"../../domain/BudgetRepository\";\nimport AmountFormatter from \"../AmountFormatter\";\nimport AmountSpent from \"../../domain/AmountSpent\";\n\nclass BudgetEntry extends Component {\n  static propTypes = {\n    amountSpent: PropTypes.instanceOf(AmountSpent),\n    categoryName: PropTypes.string,\n  };\n\n  render() {\n    let rate = '';\n    if (this.props.amountSpent.rate) {\n      let percentage = this.props.amountSpent.rate;\n      rate = <span>({percentage}%)</span>\n    }\n    return <tr>\n      <td>{this.props.categoryName}</td>\n      <td>\n        €{AmountFormatter.fromCents(this.props.amountSpent.amount).formatted()} {rate}\n      </td>\n      <td>\n        €{AmountFormatter.fromCents(this.props.amountSpent.spentPreviousMonth).formatted()}\n      </td>\n      <td>\n        €{AmountFormatter.fromCents(this.props.amountSpent.projected).formatted()}\n      </td>\n    </tr>\n  }\n}\n\nclass BudgetDash extends Component {\n  static propTypes = {\n    categoryRepository: PropTypes.instanceOf(CategoryRepository),\n    amountSpentByCategory: PropTypes.instanceOf(Map),\n    selectedMonth: PropTypes.instanceOf(BudgetRepository.YearMonth),\n  };\n\n  constructor(props) {\n    super(props);\n    this.categoriesById = this.props.categoryRepository.categoriesById();\n    let totalAmountSpent = Array.from(this.categoriesById)\n      .map(([id, category]) => {\n        return this._getAmountSpent(id).amount;\n      }).reduce((acc, amount) => acc + amount, 0);\n    this.totalAmountSpent = AmountFormatter.fromCents(totalAmountSpent).formatted()\n  }\n\n  render() {\n    const tbody = Array.from(this.categoriesById).map(([id, category]) =>\n      <BudgetEntry\n        key={id}\n        amountSpent={this._getAmountSpent(id)}\n        categoryName={this.categoriesById.get(id).name}\n      />\n    );\n    return (\n      <div>\n        <h1>Budget</h1>\n        <table className='category-budget-table'>\n          <thead>\n          <tr className='category-budget'>\n            <th>Category</th>\n            <th>Total spent</th>\n            <th>Previous month</th>\n            <th>Projected</th>\n          </tr>\n          </thead>\n          <tbody>\n          {tbody}\n          </tbody>\n        </table>\n        <p>Total expenses: €{this.totalAmountSpent}</p>\n      </div>\n    );\n  }\n\n  getAmount(categoryId) {\n    return AmountFormatter.fromCents(this._getAmountSpent(categoryId).amount).formatted();\n  }\n\n  getProjection(categoryId) {\n    return AmountFormatter.fromCents(this._getAmountSpent(categoryId).projected).formatted();\n  }\n\n  _getAmountSpent(categoryId) {\n    let amountSpent = this.props.amountSpentByCategory.get(categoryId);\n    return amountSpent ? amountSpent : new AmountSpent(0);\n  }\n}\n\nexport default BudgetDash;\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport BudgetRepository from \"../../domain/BudgetRepository\";\n\nclass MonthSelector extends Component {\n  static propTypes = {\n    budgetRepository: PropTypes.instanceOf(BudgetRepository),\n    onMonthChanged: PropTypes.func,\n  };\n\n  monthChanged(event) {\n    this.props.onMonthChanged(this.props.budgetRepository.findMonth(event.target.value));\n  }\n\n  render() {\n    let months = this.props.budgetRepository.listMonths();\n    let currentMonth = this.props.budgetRepository.currentMonth();\n    let options = months.map(month => {\n      return <option\n        value={month.yearMonth}\n        key={month.yearMonth}>\n        {month.formatted()}\n      </option>\n    });\n    return (\n      <div>\n        <select\n          defaultValue={currentMonth.yearMonth}\n          onChange={this.monthChanged.bind(this)}>\n          {options}\n        </select>\n      </div>\n    );\n  }\n\n}\n\nexport default MonthSelector;\n","let API_ENDPOINT = \"https://t2zbab4l06.execute-api.eu-central-1.amazonaws.com/Prod\";\n\nclass SyncService {\n\n  constructor(apiKey, userUuid) {\n    this._apiKey = apiKey;\n    this._userUuid = userUuid;\n  }\n\n  sync(dump) {\n    return fetch(\n      `${API_ENDPOINT}/sync/${this._userUuid}`,\n      {\n        method: 'POST',\n        mode: 'cors',\n        headers: {\n          'X-Api-Key': this._apiKey,\n        },\n        body: dump,\n      }\n    ).then(response => response.json())\n      .then(response => {\n          if (Array.isArray(response)) {\n            let jsonResponse = JSON.stringify(response);\n            return {\n              dump: jsonResponse,\n              success: true\n            };\n          }\n\n          return {\n            dump: JSON.stringify(response.allExpenses),\n            deletedExpenses: JSON.stringify(response.deletedExpenses),\n            newExpenses: JSON.stringify(response.newExpenses),\n            success: true\n          };\n        }, reason => {\n          return {\n            success: false,\n            reason: reason\n          }\n        }\n      );\n  }\n}\n\nexport default SyncService;\n","import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport ExpenseRepository from \"../../domain/ExpenseRepository\";\nimport SyncService from \"../../domain/SyncService\";\n\nclass AdminDash extends Component {\n  static propTypes = {\n    expenseRepository: PropTypes.instanceOf(ExpenseRepository),\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {};\n    this.state.loading = false;\n    this.state.uploadCompleted = \"\";\n    this.state.apiKey = this.props.expenseRepository.apiKey();\n    this.state.userUuid = this.props.expenseRepository.userUuid();\n  }\n\n  apiKeyChanged(event) {\n    this.setState({\n      apiKey: event.target.value\n    });\n    this.props.expenseRepository.saveApiKey(event.target.value);\n  }\n\n  uuidChanged(event) {\n    this.setState({\n      userUuid: event.target.value\n    });\n    this.props.expenseRepository.setUserUuid(event.target.value);\n  }\n\n  uploadExpenses() {\n    this.setState({\n      loading: true\n    });\n    let component = this;\n\n    let promise = new SyncService(this.state.apiKey, this.state.userUuid)\n      .sync(this.props.expenseRepository.dump());\n\n    promise\n      .then(\n        result => {\n          if (result.success) {\n            component.setState({\n                uploadCompleted: \"Sync completed\",\n                dump: result.dump,\n                loading: false\n              }\n            );\n            if (result.deletedExpenses) {\n              this.props.expenseRepository.deleteKeys(result.deletedExpenses);\n            }\n            if (result.newExpenses) {\n              this.props.expenseRepository.addExpenses(result.newExpenses);\n            }\n            if (result.dump && !result.newExpenses && !result.deletedExpenses) {\n              this.props.expenseRepository.loadDump(result.dump);\n            }\n          } else {\n            component.setState({\n                uploadFailed: \"Failed to sync. Reason: \" + result.reason,\n                loading: false\n              }\n            );\n          }\n        })\n  }\n\n  render() {\n    return (\n      <div>\n        <h1>Admin</h1>\n\n        <div className=\"form-group\">\n          <button\n            className='expense-form-submit button'\n            onClick={this.uploadExpenses.bind(this)}>\n            Sync expenses\n          </button>\n\n          <div className={this.state.uploadCompleted ? \"\" : \"hide\"}>\n            <div className=\"callout success\">\n              <p>{this.state.uploadCompleted}</p>\n            </div>\n          </div>\n          <div className={this.state.uploadFailed ? \"\" : \"hide\"}>\n            <div className=\"callout alert\">\n              <p>{this.state.uploadFailed}</p>\n            </div>\n          </div>\n\n          <div className={this.state.loading ? \"lds-dual-ring\" : \"hide\"}/>\n\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"apiKey\">Api key</label>\n          <input value={this.state.apiKey}\n                 className=\"form-control\"\n                 type=\"text\"\n                 id=\"apiKey\"\n                 placeholder=\"Enter api key\"\n                 onChange={this.apiKeyChanged.bind(this)}/>\n\n          <label htmlFor=\"userUuid\">User uuid</label>\n          <input value={this.state.userUuid}\n                 className=\"form-control\"\n                 type=\"text\"\n                 id=\"userUuid\"\n                 placeholder=\"Enter user UUID\"\n                 onChange={this.uuidChanged.bind(this)}/>\n        </div>\n\n        <hr/>\n\n      </div>\n    );\n  }\n\n}\n\nexport default AdminDash;\n","import React, {Component} from 'react';\nimport ExpensesDash from \"./ExpensesDash\";\nimport BudgetDash from \"./BudgetDash\";\nimport MonthSelector from \"./MonthSelector\";\nimport AdminDash from \"./AdminDash\";\nimport {BrowserRouter as Router, Link, Route} from 'react-router-dom'\nimport UUIDGenerator from \"../../domain/UUIDGenerator\";\nimport CategoryRepository from \"../../domain/CategoryRepository\";\nimport BudgetRepository from \"../../domain/BudgetRepository\";\nimport ExpenseRepository from \"../../domain/ExpenseRepository\";\nimport SyncService from \"../../domain/SyncService\";\nimport moment from 'moment';\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n    this.categoryRepository = new CategoryRepository();\n    this.budgetRepository = new BudgetRepository(localStorage, this.categoryRepository);\n    this.expenseRepository = new ExpenseRepository(localStorage);\n\n    this.state = {\n      selectedMonth: this.budgetRepository.currentMonth()\n    }\n  }\n\n  syncBackendState() {\n    let apiKey = this.expenseRepository.apiKey();\n    let userUuid = this.expenseRepository.userUuid();\n    let thiz = this;\n\n    if (apiKey && userUuid && this.expenseRepository.shouldSync(moment())) {\n\n      new SyncService(apiKey, userUuid)\n        .sync(this.expenseRepository.dump())\n        .then(result => {\n          if (result.success) {\n            thiz.expenseRepository.loadDump(result.dump);\n            thiz.expenseRepository.synced();\n            thiz.setState({\n              selectedMonth: thiz.budgetRepository.currentMonth()\n            });\n          }\n        });\n    }\n  }\n\n  makeExpensesDash() {\n    return <ExpensesDash\n      idGenerator={new UUIDGenerator()}\n      categoryRepository={this.categoryRepository}\n      selectedMonth={this.state.selectedMonth}\n    />;\n  }\n\n  makeBudgetDash() {\n    return <BudgetDash\n      categoryRepository={this.categoryRepository}\n      budgetRepository={this.budgetRepository}\n      amountSpentByCategory={this.expenseRepository.amountsByCategory(this.state.selectedMonth)}\n      selectedMonth={this.state.selectedMonth}\n    />\n  }\n\n  componentDidMount() {\n    this.syncBackendState();\n  }\n\n  makeAdminDash() {\n    return <AdminDash\n      expenseRepository={this.expenseRepository}\n    />\n  }\n\n  monthChanged(month) {\n    this.setState({\n      selectedMonth: month\n    });\n  }\n\n  render() {\n    return (\n      <Router>\n        <div>\n          <div className=\"top-bar\" id=\"responsive-menu\">\n            <div className=\"top-bar-left\">\n              <ul className=\"dropdown menu\" data-dropdown-menu>\n                <li className=\"menu-text\"><Link to=\"/nummus/\">Nummus</Link></li>\n                <li>\n                  <Link to=\"/nummus/budget/\">Budget</Link>\n                </li>\n                <li>\n                  <Link to=\"/nummus/admin\">Admin</Link>\n                </li>\n                <li>\n                  <MonthSelector budgetRepository={this.budgetRepository}\n                                 onMonthChanged={this.monthChanged.bind(this)}/>\n                </li>\n              </ul>\n            </div>\n          </div>\n          <div className=\"grid-container main-container\">\n            <Route exact path=\"/nummus/\" component={this.makeExpensesDash.bind(this)}/>\n            <Route path=\"/nummus/budget/\" component={this.makeBudgetDash.bind(this)}/>\n            <Route path=\"/nummus/admin/\" component={this.makeAdminDash.bind(this)}/>\n          </div>\n        </div>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  const shouldRegister = process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator;\n  // const shouldRegister = true;\n  if (shouldRegister) {\n    window.addEventListener(\"beforeinstallprompt\", function(e) {\n      // log the platforms provided as options in an install prompt\n      console.log(e.platforms); // e.g., [\"web\", \"android\", \"windows\"]\n      e.userChoice.then(function(outcome) {\n        console.log(outcome); // either \"accepted\" or \"dismissed\"\n      }, () => undefined);\n    });\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './main/css/index.css';\nimport App from './main/js/application/components/App';\nimport registerServiceWorker from './main/js/registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}